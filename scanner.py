import requests
from bs4 import BeautifulSoup

# Vulnerability checks
def scan_for_sql_injection(url):
    payloads = ["' OR '1'='1", "' OR '1'='1' --", '" OR "" = "']
    results = []
    for payload in payloads:
        test_url = f"{url}?id={payload}"
        response = requests.get(test_url)
        if "error" in response.text.lower():  # Simple heuristic for errors
            results.append(f"Possible SQL Injection with payload: {payload}")
    return results if results else "No SQL Injection vulnerabilities detected."

def scan_for_xss(url):
    payloads = ['<script>alert("XSS")</script>', '"><img src="x" onerror="alert(1)">']
    results = []
    for payload in payloads:
        test_url = f"{url}?search={payload}"
        response = requests.get(test_url)
        if payload in response.text:
            results.append(f"Possible XSS vulnerability with payload: {payload}")
    return results if results else "No XSS vulnerabilities detected."

def scan_website(url, vulnerabilities):
    results = {}
    if 'SQL Injection' in vulnerabilities:
        results['SQL Injection'] = scan_for_sql_injection(url)
    if 'XSS' in vulnerabilities:
        results['XSS'] = scan_for_xss(url)
    # Implement checks for other vulnerabilities similarly
    return results
